name: container_security_scan
description: Docker container and image security scanning

targets:
  - nginx:latest
  - redis:latest
  - postgres:14
  - node:16-alpine

tests:
  - name: vulnerability_scan
    type: trivy
    enabled: true
    scan_type: image
    severity: "CRITICAL,HIGH,MEDIUM"

thresholds:
  critical: 0
  high: 3
  medium: 10

notifications:
  always_notify: false
  webhook_url: "${WEBHOOK_URL}"

parallel: true
stop_on_failure: true  # Stop if critical vulnerabilities found